// Generated by CoffeeScript 1.6.3
(function() {
  define(['R', 'Clock'], function(R, Clock) {
    var $playBtn, $stopBtn, fnPlayPause, fnStop, port, _pause, _play, _stop;
    port = chrome.runtime.connect();
    $playBtn = $stopBtn = null;
    _play = function() {
      return $playBtn.removeClass('play').addClass('pause').children().removeClass('uk-icon-play').addClass('uk-icon-pause');
    };
    _pause = function() {
      return $playBtn.removeClass('pause').addClass('play').children().removeClass('uk-icon-pause').addClass('uk-icon-play');
    };
    _stop = function() {
      if ($playBtn.hasClass('pause')) {
        _pause();
      }
      return Clock.reset();
    };
    fnPlayPause = function() {
      if ($playBtn.hasClass('play')) {
        chrome.runtime.sendMessage({
          "type": R.string.start_timer,
          "time": R.int.default_time
        });
        return _play();
      } else if ($playBtn.hasClass('pause')) {
        chrome.runtime.sendMessage({
          "type": R.string.pause_timer
        });
        return _pause();
      }
    };
    fnStop = function() {
      chrome.runtime.sendMessage({
        "type": R.string.stop_timer
      });
      return _stop();
    };
    $(document).ready(function() {
      console.log('init player');
      $playBtn = $('.play').click(fnPlayPause);
      return $stopBtn = $('.stop').click(fnStop);
    });
    return port.onMessage.addListener(function(msg) {
      return Clock.update(msg.s);
    });
  });

}).call(this);
